<!DOCTYPE html>
<html lang="en">
<head>
    <title>Exchange Rates USD/BYN EUR/BYN BYN/PLN</title>
    <meta charset="utf-8"/>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
          integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <style>
        /* Styling the spinner */
        .spinner-xyz {
            animation: 1s linear 0s normal none infinite running rot;
            -webkit-animation: 1s linear 0s normal none infinite running rot;
        }

        @-webkit-keyframes rot {
            0% {
                transform: rotate(0deg);
            }
            25% {
                transform: rotate(90deg);
            }
            50% {
                transform: rotate(180deg);
            }
            75% {
                transform: rotate(270deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        body {
            font-size: 2rem;
            background-color: gray;
        }

        table th {
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container-fluid" style="max-width: 30em">
    <table class="table table-striped table-info table-hover" id="sortTable">
        <thead class="thead-dark">
        <tr class="bg-info">
            <th scope="col">BANK
                <span style="font-size: 0.3em" class="badge badge-light bg-sm">MC|VISA</span>
            </th>
            <th scope="col" onclick="sortTable(0)">USD/BYN</th>
            <th scope="col" onclick="sortTable(1)">EUR/BYN</th>
            <th scope="col">UPDATE</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th scope="row">
                <a class="badge badge-danger" href="https://www.bsb.by/obmen-valyut">BSB</a>
                <span style="font-size: 0.3em" class="badge badge-light bg-sm">PLN|EUR</span>
            </th>
            <td>
                <section id="print-BSB-USD"></section>
            </td>
            <td>
                <section id="print-BSB-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingBSB" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdateBSB" class="btn btn-info" type="button" onclick="requestPostBSB()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
        </tr>
        <tr>
            <th scope="row">
                <a class="badge badge-warning" href="https://bnb.by/kursy-valyut/imbank/">BNB</a>
                <span style="font-size: 0.3em" class="badge badge-light bg-sm">CNY|USD</span>
            </th>
            <td>
                <section id="print-BNB-USD"></section>
            </td>
            <td>
                <section id="print-BNB-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingBNB" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdateBNB" class="btn btn-info" type="button" onclick="requestPostBNB()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
            </td>
        </tr>
        <tr>
            <th scope="row">
                <a class="badge badge-dark" href="https://www.alfabank.by/exchange/digital/">Alfa</a>
                <span style="font-size: 0.3em" class="badge badge-light bg-sm">CNY|USD</span>
            </th>
            <td>
                <section id="print-Alfa-USD"></section>
            </td>
            <td>
                <section id="print-Alfa-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingAlfa" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdateAlfa" class="btn btn-info" type="button" onclick="requestPostAlfa()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
        </tr>
        <tr>
            <th scope="row"><a class="badge badge-light" href="https://www.paritetbank.by/private/rates/">Paritet</a>
            </th>
            <td>
                <section id="print-Paritet-USD"></section>
            </td>
            <td>
                <section id="print-Paritet-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingParitet" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdateParitet" class="btn btn-info" type="button" onclick="requestPostParitet()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
        </tr>
        <tr>
            <th scope="row"><a class="badge badge-primary" href="https://belgazprombank.by/about/kursi_valjut/">BGPB</a>
            </th>
            <td>
                <section id="print-BGPB-USD"></section>
            </td>
            <td>
                <section id="print-BGPB-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingBGPB" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdateBGPB" class="btn btn-info" type="button" onclick="requestPostBGPB()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
        </tr>
        <tr>
            <th scope="row">
                <a class="badge badge-secondary" href="https://www.mtbank.by/courses/cards/">MTB</a>
                <span style="font-size: 0.3em" class="badge badge-light bg-sm">USD|USD</span>
            </th>
            <td>
                <section id="print-MTB-USD"></section>
            </td>
            <td>
                <section id="print-MTB-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingMTB" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdateMTB" class="btn btn-info" type="button" onclick="requestPostMTB()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
        </tr>
        <tr>
            <th scope="row">
                <a class="badge badge-success" href="https://www.mtbank.by/courses/cards/">PayOkay</a>
                <span style="font-size: 0.3em" class="badge badge-light bg-sm">USD|USD</span>
            </th>
            <td>
                <section id="print-PayOkay-USD"></section>
            </td>
            <td>
                <section id="print-PayOkay-EUR"></section>
            </td>
            <td>
                <button id="btnLoadingPayOkay" style="display: none;" class="btn btn-secondary" type="button" disabled>
                    <section class="spinner-xyz">
                        <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    </section>
                    <span class="sr-only">Loading...</span>
                </button>
                <button id="btnUpdatePayOkay" class="btn btn-info" type="button" onclick="requestPostPayOkay()">
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update</span>
                </button>
        </tr>
        </tbody>
    </table>

    <div class="container-fluid" style="max-width: 15em">
        <div class="input-group  input-group-lg">
            <div class="input-group-prepend" style="font-size: x-large">
                <button style="font-size: x-large" id="btnUpdateBGPB2" class="btn btn-lg btn-primary" type="button"
                        onclick="requestPostBGPB()">
                    <span class="">BGPB   </span>
                    <span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update BGPB</span>
                </button>
                <span style="font-size: x-large" class="input-group-text">BYN/PLN</span>
            </div>
            <input style="font-size: xx-large" id="BGPB-BYN-PLN" readonly type="text" class="form-control"
                   placeholder="0.0"
                   aria-label="BYN/PLN">
        </div>
    </div>
    <br>

    <table class="table table-striped table-secondary table-hover">
        <thead class="thead-dark">
        <tr>
            <th scope="col">Trans->Card</th>
            <th scope="col">
                <button id="btnUpdateMC" class="btn btn-lg btn-danger" type="button" onclick="updateMC()">
                    <span>MC   </span><span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update MC</span>
                </button>
            </th>
            <th scope="col">
                <button id="btnUpdateVisa" class="btn btn-lg btn-primary" type="button" onclick="updateVisa()">
                    <span>Visa   </span><span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update Visa</span>
                </button>
            </th>
            <th scope="col">
                <button id="btnUpdateRev" class="btn btn-lg btn-light" type="button" onclick="updateRev()">
                    <span>Revolut   </span><span class="bi bi-arrow-repeat" role="status" aria-hidden="true"></span>
                    <span class="sr-only">Update Revolut</span>
                </button>
            </th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th scope="row">EUR->USD</th>
            <td><span id="EUR-USD-MC"></span></td>
            <td><span id="EUR-USD-VISA"></span></td>
            <td><span id="EUR-USD-REV"></span></td>
        </tr>
        <tr>
            <th scope="row">USD->EUR</th>
            <td><span id="USD-EUR-MC"></span></td>
            <td><span id="USD-EUR-VISA"></span></td>
            <td><span id="USD-EUR-REV"></span></td>
        </tr>
        <tr>
            <th scope="row">PLN->USD</th>
            <td><span id="PLN-USD-MC"></span></td>
            <td><span id="PLN-USD-VISA"></span></td>
            <td><span id="PLN-USD-REV"></span></td>
        </tr>
        <tr>
            <th scope="row">PLN->EUR</th>
            <td><span id="PLN-EUR-MC"></span></td>
            <td><span id="PLN-EUR-VISA"></span></td>
            <td><span id="PLN-EUR-REV"></span></td>
        </tr>
        <tr class="table-dark">
            <th scope="row">PLN->BYN</th>
            <td><span id="PLN-BYN-MC"></span></td>
            <td><span id="PLN-BYN-VISA"></span></td>
            <td><span id="PLN-BYN-REV"></span></td>
        </tr>
        <tr class="table-dark">
            <th scope="row">USD->BYN</th>
            <td><span id="USD-BYN-MC"></span></td>
            <td><span id="USD-BYN-VISA"></span></td>
            <td><span id="USD-BYN-REV"></span></td>
        </tr>
        </tbody>
    </table>

</div>

<script>

    const userAgent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36';
    const proxyUrl = 'https://nocors.riko.ws/?';

    function fetchWithProxy(url, params, cors){
        let noCorsParams = new URLSearchParams({
            cors: 'no-cors',
            headers: {
                'User-Agent': userAgent,
		        accept: 'application/json',
            },
            method: 'GET',
        });

        if(cors == true && (params != null || params != '')){
            console.log(`URL for POST: ${proxyUrl}${url}${encodeURIComponent(url + params)}${noCorsParams}`);
            return fetch(proxyUrl + encodeURIComponent(url + params), noCorsParams);
        }
        if(cors == true && (params == null || params == '')){
            console.log(`URL for POST: ${proxyUrl}${url}${noCorsParams}`);
            return fetch(proxyUrl + url, noCorsParams);
        }
        if(cors != true && (params != null || params != '')){
            console.log(`URL for POST: ${proxyUrl}${url}${params}`);
            return fetch(proxyUrl + encodeURIComponent(url + params));
        }
            console.log(`URL for POST: ${proxyUrl}${url}`);
            return fetch(proxyUrl + url);
    }

    function updateRev() {
        const btnUpdate = document.getElementById("btnUpdateRev");
        if (!isExist(btnUpdate)) {
            return;
        }

        const elEURtoUSDbyRev = document.getElementById("EUR-USD-REV");
        const elUSDtoEURbyRev = document.getElementById("USD-EUR-REV");
        const elPLNtoUSDbyRev = document.getElementById("PLN-USD-REV");
        const elPLNtoEURbyRev = document.getElementById("PLN-EUR-REV");
        const elPLNtoBYNbyRev = document.getElementById("PLN-BYN-REV");
        const elUSDtoBYNbyRev = document.getElementById("USD-BYN-REV");

        const urlRev = 'https://www.revolut.com/api/exchange/quote?';

        const urlParamEURtoUSDbyRev = new URLSearchParams({
            country: 'DE',
            fromCurrency: 'USD',
            toCurrency: 'EUR',
            amount: 1,
            isRecipientAmount: false
        });
        elEURtoUSDbyRev.innerText = null;

        fetchWithProxy(urlRev, urlParamEURtoUSDbyRev, true)
        .then(response => {
            response.json()
                .then(res => {
                    elEURtoUSDbyRev.innerText = (1 / res.rate.rate).toFixed(4);
                })
        }).catch(error => {
            elEURtoUSDbyRev.innerText = 'error';
            console.error(error);
        });

        const urlParamUSDtoEURbyRev = new URLSearchParams({
            country: 'DE',
            fromCurrency: 'EUR',
            toCurrency: 'USD',
            amount: 1,
            isRecipientAmount: false
        });
        elUSDtoEURbyRev.innerText = null;

        fetchWithProxy(urlRev, urlParamUSDtoEURbyRev, true)
        .then(response => {
            response.json()
                .then(res => {
                    elUSDtoEURbyRev.innerText = (res.rate.rate).toFixed(4);
                })
        }).catch(error => {
            elUSDtoEURbyRev.innerText = 'error';
            console.error(error);
        });

        const urlParamPLNtoUSDbyRev = new URLSearchParams({
            country: 'DE',
            fromCurrency: 'USD',
            toCurrency: 'PLN',
            amount: 1,
            isRecipientAmount: false
        });
        elPLNtoUSDbyRev.innerText = null;

        fetchWithProxy(urlRev, urlParamPLNtoUSDbyRev, true)
        .then(response => {
            response.json()
                .then(res => {
                    elPLNtoUSDbyRev.innerText = (res.rate.rate).toFixed(4);
                })
        }).catch(error => {
            elPLNtoUSDbyRev.innerText = 'error';
            console.error(error);
        });

        const urlParamPLNtoEURbyRev = new URLSearchParams({
            country: 'DE',
            fromCurrency: 'EUR',
            toCurrency: 'PLN',
            amount: 1,
            isRecipientAmount: false
        });
        elPLNtoEURbyRev.innerText = null;

        fetchWithProxy(urlRev, urlParamPLNtoEURbyRev, true)
        .then(response => {
            response.json()
                .then(res => {
                    elPLNtoEURbyRev.innerText = (res.rate.rate).toFixed(4);
                })
        }).catch(error => {
            elPLNtoEURbyRev.innerText = 'error';
            console.error(error);
        });

        const urlParamPLNtoBYNbyRev = new URLSearchParams({
            country: 'DE',
            fromCurrency: 'BYN',
            toCurrency: 'PLN',
            amount: 1,
            isRecipientAmount: false
        });
        elPLNtoBYNbyRev.innerText = null;

        fetchWithProxy(urlRev, urlParamPLNtoBYNbyRev, true)
        .then(response => {
            response.json()
                .then(res => {
                    elPLNtoBYNbyRev.innerText = (res.rate.rate).toFixed(4);
                })
        }).catch(error => {
            elPLNtoBYNbyRev.innerText = 'error';
            console.error(error);
        });

        const urlParamUSDtoBYNbyRev = new URLSearchParams({
            country: 'DE',
            fromCurrency: 'BYN',
            toCurrency: 'USD',
            amount: 1,
            isRecipientAmount: false
        });
        elUSDtoBYNbyRev.innerText = null;

        fetchWithProxy(urlRev, urlParamUSDtoBYNbyRev, true)
        .then(response => {
            response.json()
                .then(res => {
                    elUSDtoBYNbyRev.innerText = (1 / res.rate.rate).toFixed(4);
                })
        }).catch(error => {
            elUSDtoBYNbyRev.innerText = 'error';
            console.error(error);
        });
    }

    function updateMC() {
        const btnUpdate = document.getElementById("btnUpdateMC");
        if (!isExist(btnUpdate)) {
            return;
        }

        const elEURtoUSDbyMC = document.getElementById("EUR-USD-MC");
        const elUSDtoEURbyMC = document.getElementById("USD-EUR-MC");
        const elPLNtoUSDbyMC = document.getElementById("PLN-USD-MC");
        const elPLNtoEURbyMC = document.getElementById("PLN-EUR-MC");
        const elPLNtoBYNbyMC = document.getElementById("PLN-BYN-MC");
        const elUSDtoBYNbyMC = document.getElementById("USD-BYN-MC");

        const urlMC = 'https://www.mastercard.com/settlement/currencyrate/conversion-rate?';
        const urlParamEURtoUSDbyMS = new URLSearchParams({
            fxDate: '0000-00-00',
            transCurr: 'EUR',
            crdhldBillCurr: 'USD',
            bankFee: 0,
            transAmt: 1
        });
        elEURtoUSDbyMC.innerText = null;

        fetchWithProxy(urlMC, urlParamEURtoUSDbyMS, true)
        .then(response => {
            response.json()
                .then(res => {
                    elEURtoUSDbyMC.innerText = res.data['conversionRate'].toFixed(4);
                })
        }).catch(error => {
            elEURtoUSDbyMC.innerText = 'error';
            console.error(error);
        });

        const urlParamUSDtoEURbyMC = new URLSearchParams({
            fxDate: '0000-00-00',
            transCurr: 'USD',
            crdhldBillCurr: 'EUR',
            bankFee: 0,
            transAmt: 1
        });
        elUSDtoEURbyMC.innerText = null;

        fetchWithProxy(urlMC, urlParamUSDtoEURbyMC, true)
        .then(response => {
            response.json()
                .then(res => {
                    elUSDtoEURbyMC.innerText = (1 / res.data['conversionRate']).toFixed(4);
                })
        }).catch(error => {
            elUSDtoEURbyMC.innerText = 'error';
            console.error(error);
        });

        const urlParamPLNtoUSDbyMC = new URLSearchParams({
            fxDate: '0000-00-00',
            transCurr: 'PLN',
            crdhldBillCurr: 'USD',
            bankFee: 0,
            transAmt: 1
        });
        elPLNtoUSDbyMC.innerText = null;

        fetchWithProxy(urlMC, urlParamPLNtoUSDbyMC, true)
        .then(response => {
            response.json()
                .then(res => {
                    elPLNtoUSDbyMC.innerText = (1 / res.data['conversionRate']).toFixed(4);
                })
        }).catch(error => {
            elPLNtoUSDbyMC.innerText = 'error';
            console.error(error);
        });

        const urlParamPLNtoEURbyMC = new URLSearchParams({
            fxDate: '0000-00-00',
            transCurr: 'PLN',
            crdhldBillCurr: 'EUR',
            bankFee: 0,
            transAmt: 1
        });
        elPLNtoEURbyMC.innerText = null;

        fetchWithProxy(urlMC, urlParamPLNtoEURbyMC, true)
        .then(response => {
            response.json()
                .then(res => {
                    elPLNtoEURbyMC.innerText = (1 / res.data['conversionRate']).toFixed(4);
                })
        }).catch(error => {
            elPLNtoEURbyMC.innerText = 'error';
            console.error(error);
        });

        const urlParamPLNtoBYNbyMC = new URLSearchParams({
            fxDate: '0000-00-00',
            transCurr: 'PLN',
            crdhldBillCurr: 'BYN',
            bankFee: 0,
            transAmt: 1
        });
        elPLNtoBYNbyMC.innerText = null;

        fetchWithProxy(urlMC, urlParamPLNtoBYNbyMC, true)
        .then(response => {
            response.json()
                .then(res => {
                    elPLNtoBYNbyMC.innerText = (1 / res.data['conversionRate']).toFixed(4);
                })
        }).catch(error => {
            elPLNtoBYNbyMC.innerText = 'error';
            console.error(error);
        });

        const urlParamUSDtoBYNbyMC = new URLSearchParams({
            fxDate: '0000-00-00',
            transCurr: 'USD',
            crdhldBillCurr: 'BYN',
            bankFee: 0,
            transAmt: 1
        });
        elUSDtoBYNbyMC.innerText = null;

        fetchWithProxy(urlMC, urlParamUSDtoBYNbyMC, true)
        .then(response => {
            response.json()
                .then(res => {
                    elUSDtoBYNbyMC.innerText = (res.data['conversionRate']).toFixed(4);
                })
        }).catch(error => {
            elUSDtoBYNbyMC.innerText = 'error';
            console.error(error);
        });
    }

    function updateVisa() {
        const btnUpdate = document.getElementById("btnUpdateVisa");
        if (!isExist(btnUpdate)) {
            return;
        }

        const elEURtoUSDbyVISA = document.getElementById("EUR-USD-VISA");
        const elUSDtoEURbyVISA = document.getElementById("USD-EUR-VISA");
        const elPLNtoUSDbyVISA = document.getElementById("PLN-USD-VISA");
        const elPLNtoEURbyVISA = document.getElementById("PLN-EUR-VISA");
        const elPLNtoBYNbyVISA = document.getElementById("PLN-BYN-VISA");
        const elUSDtoBYNbyVISA = document.getElementById("USD-BYN-VISA");

        const urlVISA = 'https://www.visa.de/cmsapi/fx/rates?';
        const urlParamEURtoUSDbyVISA = new URLSearchParams({
            amount: 1,
            fee: 0,
            utcConvertedDate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            exchangedate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            fromCurr: 'USD',
            toCurr: 'EUR'
        });
        elEURtoUSDbyVISA.innerText = null;

        fetchWithProxy(urlVISA, urlParamEURtoUSDbyVISA, true)
            .then(response => {
                response.json()
                    .then(res => {
                        elEURtoUSDbyVISA.innerText = (1 / res['originalValues']['fxRateVisa']).toFixed(4);
                    })
            }).catch(error => {
                elEURtoUSDbyVISA.innerText = 'error';
                console.error(error);
            });

        const urlParamUSDtoEURbyVISA = new URLSearchParams({
            amount: 1,
            fee: 0,
            utcConvertedDate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            exchangedate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            fromCurr: 'EUR',
            toCurr: 'USD'
        });
        elUSDtoEURbyVISA.innerText = null;

        fetchWithProxy(urlVISA, urlParamEURtoUSDbyVISA, true)
            .then(response => {
                response.json()
                    .then(res => {
                        elUSDtoEURbyVISA.innerText = (1 / res['originalValues']['fxRateVisa']).toFixed(4);
                    })
            }).catch(error => {
                elUSDtoEURbyVISA.innerText = 'error';
                console.error(error);
            });

        const urlParamPLNtoUSDbyVISA = new URLSearchParams({
            amount: 1,
            fee: 0,
            utcConvertedDate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            exchangedate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            fromCurr: 'USD',
            toCurr: 'PLN'
        });
        elPLNtoUSDbyVISA.innerText = null;

        fetchWithProxy(urlVISA, urlParamPLNtoUSDbyVISA, true)
            .then(response => {
                response.json()
                    .then(res => {
                        elPLNtoUSDbyVISA.innerText = (1 / res['originalValues']['fxRateVisa']).toFixed(4);
                    })
            }).catch(error => {
                elPLNtoUSDbyVISA.innerText = 'error';
                console.error(error);
            });

        const urlParamPLNtoEURbyVISA = new URLSearchParams({
            amount: 1,
            fee: 0,
            utcConvertedDate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            exchangedate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            fromCurr: 'EUR',
            toCurr: 'PLN'
        });
        elPLNtoEURbyVISA.innerText = null;

        fetchWithProxy(urlVISA, urlParamPLNtoEURbyVISA, true)
            .then(response => {
                response.json()
                    .then(res => {
                        elPLNtoEURbyVISA.innerText = (1 / res['originalValues']['fxRateVisa']).toFixed(4);
                    })
            }).catch(error => {
                elPLNtoEURbyVISA.innerText = 'error';
                console.error(error);
            });

        const urlParamPLNtoBYNbyVISA = new URLSearchParams({
            amount: 1,
            fee: 0,
            utcConvertedDate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            exchangedate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            fromCurr: 'BYN',
            toCurr: 'PLN'
        });
        elPLNtoBYNbyVISA.innerText = null;

        fetchWithProxy(urlVISA, urlParamPLNtoBYNbyVISA, true)
            .then(response => {
                response.json()
                    .then(res => {
                        elPLNtoBYNbyVISA.innerText = (1 / res['originalValues']['fxRateVisa']).toFixed(4);
                    })
            }).catch(error => {
                elPLNtoBYNbyVISA.innerText = 'error';
                console.error(error);
            });

        const urlParamUSDtoBYNbyVISA = new URLSearchParams({
            amount: 1,
            fee: 0,
            utcConvertedDate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            exchangedate: new Date().toLocaleDateString('en-us', {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
            }),
            fromCurr: 'BYN',
            toCurr: 'USD'
        });

        elUSDtoBYNbyVISA.innerText = null;
        fetchWithProxy(urlVISA, urlParamUSDtoBYNbyVISA, true)
        .then(response => {
            response.json()
                .then(res => {
                    elUSDtoBYNbyVISA.innerText = Number.parseFloat(res['originalValues']['fxRateVisa']).toFixed(4);
                })
        }).catch(error => {
            elUSDtoBYNbyVISA.innerText = 'error';
            console.error(error);
        });
    }

    function requestPostBSB() {
        const btnUpdate = document.getElementById("btnUpdateBSB");
        const btnLoading = document.getElementById("btnLoadingBSB");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlBsb = 'https://mobile.bsb.by/api/v1/free-zone-management/exchange-rates/rates';
        console.log('URL for POST:', urlBsb);

        fetch(urlBsb, {
            body: JSON.stringify({
                'period': Date.parse(new Date().toString()),
                'type': 'CARD'
            }),
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'User-Agent': userAgent
            },
            method: 'POST',
            redirect: 'follow'
        })
            .then(response => {
                response.json()
                    .then(res => {
                        let rates = res['rates'];

                        let rateUSD = rates[0].sellAmount.toFixed(4);
                        let rateEUR = rates[1].sellAmount.toFixed(4);
                        let ratePLN = (1 / rates[6].sellAmount).toFixed(4);

                        document.getElementById("print-BSB-USD").innerText = rateUSD;
                        document.getElementById("print-BSB-EUR").innerText = rateEUR;
                        // document.getElementById("print-BSB-PLN").innerText = ratePLN;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function requestPostBNB() {
        const btnUpdate = document.getElementById("btnUpdateBNB");
        const btnLoading = document.getElementById("btnLoadingBNB");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlBNB = 'https://bnb.by/kursy-valyut/imbank/';

        fetchWithProxy(urlBNB,'',true)
            .then(response => {
                response.text()
                    .then(res => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(res, "text/html");
                        let rates = JSON.parse(doc.querySelector('input.jsConfig').value);

                        let rateUSD = rates['USD']['BYN']['SALE'].toFixed(4);
                        let rateEUR = rates['EUR']['BYN']['SALE'].toFixed(4);
                        let ratePLN = (1 / rates['PLN']['BYN']['SALE']).toFixed(4);

                        document.getElementById("print-BNB-USD").innerText = rateUSD;
                        document.getElementById("print-BNB-EUR").innerText = rateEUR;
                        // document.getElementById("print-BNB-PLN").innerText = ratePLN;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function requestPostAlfa() {
        const btnUpdate = document.getElementById("btnUpdateAlfa");
        const btnLoading = document.getElementById("btnLoadingAlfa");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlAlfa = 'https://www.alfabank.by/exchange/digital/';

        fetchWithProxy(urlAlfa,'',true)
            .then(response => {
                response.text()
                    .then(res => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(res, "text/html");
                        let obj = doc.querySelector('div.section-content div[data-component]');
                        let rates = JSON.parse(obj.getAttribute('data-initial'));

                        let rateUSD = Number.parseFloat(rates['initialItems']['0']['currenciesData']['0']['value']['exchangeRate']['0']['sell']['value']).toFixed(4);
                        let rateEUR = Number.parseFloat(rates['initialItems']['0']['currenciesData']['0']['value']['exchangeRate']['1']['sell']['value']).toFixed(4);

                        document.getElementById("print-Alfa-USD").innerText = rateUSD;
                        document.getElementById("print-Alfa-EUR").innerText = rateEUR;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function requestPostParitet() {
        const btnUpdate = document.getElementById("btnUpdateParitet");
        const btnLoading = document.getElementById("btnLoadingParitet");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlParitet = 'https://www.paritetbank.by/private/rates/';

        fetchWithProxy(urlParitet,'',true)
            .then(response => {
                response.text()
                    .then(res => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(res, "text/html");
                        let conversion = Array.from(doc.scripts).find(s => s.innerText.includes("var conversion")).innerText;

                        let rates = JSON.parse(conversion.substring(conversion.indexOf("{"), conversion.lastIndexOf("}") + 1));
                        let rateUSD = rates['4']['USDBYN']['BUY'].toFixed(4);
                        let rateEUR = rates['4']['EURBYN']['BUY'].toFixed(4);

                        document.getElementById("print-Paritet-USD").innerText = rateUSD;
                        document.getElementById("print-Paritet-EUR").innerText = rateEUR;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function requestPostBGPB() {
        const btnUpdate = document.getElementById("btnUpdateBGPB");
        const btnLoading = document.getElementById("btnLoadingBGPB");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlBGPB = 'https://belgazprombank.by/about/kursi_valjut/';

        fetchWithProxy(urlBGPB,'',true)
            .then(response => {
                response.text()
                    .then(res => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(res, "text/html");

                        let conversionUSD = Array.from(doc.scripts).find(s => s.innerText.includes("currencyChartUSD")).innerText;
                        let conversionEUR = Array.from(doc.scripts).find(s => s.innerText.includes("currencyChartEUR")).innerText;
                        let conversionPLN = Array.from(doc.scripts).find(s => s.innerText.includes("currencyChartPLN")).innerText;

                        let objUSD = conversionUSD.substring(conversionUSD.indexOf("[["), conversionUSD.lastIndexOf("]]") + 2);
                        let objEUR = conversionEUR.substring(conversionEUR.indexOf("[["), conversionEUR.lastIndexOf("]]") + 2);
                        let objPLN = conversionPLN.substring(conversionPLN.indexOf("[["), conversionPLN.lastIndexOf("]]") + 2);

                        let jsUSD = JSON.parse(objUSD);
                        let jsEUR = JSON.parse(objEUR);
                        let jsPLN = JSON.parse(objPLN);

                        let rateUSD = (jsUSD[1][jsUSD['1']['length'] - 1]).toFixed(4);
                        let rateEUR = (jsEUR[1][jsEUR['1']['length'] - 1]).toFixed(4);
                        let ratePLN = (10 / jsPLN[1][jsPLN['1']['length'] - 1]).toFixed(4);

                        document.getElementById("print-BGPB-USD").innerText = rateUSD;
                        document.getElementById("print-BGPB-EUR").innerText = rateEUR;
                        document.getElementById("BGPB-BYN-PLN").value = ratePLN;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function requestPostMTB() {
        const btnUpdate = document.getElementById("btnUpdateMTB");
        const btnLoading = document.getElementById("btnLoadingMTB");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlMTB = 'https://www.mtbank.by/currxml.php';

        fetchWithProxy(urlMTB,'',true)
            .then(response => {
                response.text()
                    .then(res => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(res, "application/xml");

                        let rateUSD;
                        let rateEUR;

                        let currencies = doc.querySelectorAll('cards currency');

                        currencies.forEach(currency => {
                            if (currency.querySelector('code').textContent === "USD" && currency.querySelector('codeTo').textContent === "BYN") {
                                rateUSD = Number.parseFloat(currency.querySelector('sale').textContent).toFixed(4);
                            }
                            if (currency.querySelector('code').textContent === "EUR" && currency.querySelector('codeTo').textContent === "BYN") {
                                rateEUR = Number.parseFloat(currency.querySelector('sale').textContent).toFixed(4);
                            }
                        });

                        document.getElementById("print-MTB-USD").innerText = rateUSD;
                        document.getElementById("print-MTB-EUR").innerText = rateEUR;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function requestPostPayOkay() {
        const btnUpdate = document.getElementById("btnUpdatePayOkay");
        const btnLoading = document.getElementById("btnLoadingPayOkay");
        if (!isExist(btnUpdate) && !isExist(btnLoading)) {
            return;
        }

        hideElement(btnUpdate);
        showElement(btnLoading);

        let urlPayOkay = 'https://www.mtbank.by/currxml.php';

        fetchWithProxy(urlPayOkay,'',true)
            .then(response => {
                response.text()
                    .then(res => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(res, "application/xml");

                        let rateUSD;
                        let rateEUR;

                        let currencies = doc.querySelectorAll('payokay currency');

                        currencies.forEach(currency => {
                            if (currency.querySelector('code').textContent === "USD" && currency.querySelector('codeTo').textContent === "BYN") {
                                rateUSD = Number.parseFloat(currency.querySelector('sale').textContent).toFixed(4);
                            }
                            if (currency.querySelector('code').textContent === "EUR" && currency.querySelector('codeTo').textContent === "BYN") {
                                rateEUR = Number.parseFloat(currency.querySelector('sale').textContent).toFixed(4);
                            }
                        });

                        document.getElementById("print-PayOkay-USD").innerText = rateUSD;
                        document.getElementById("print-PayOkay-EUR").innerText = rateEUR;

                        setBlueColor(btnUpdate);
                        showElement(btnUpdate);
                        hideElement(btnLoading);

                        sortTable();
                    })
            })
            .catch(error => {
                setRedColor(btnUpdate);
                showElement(btnUpdate);
                hideElement(btnLoading);
                console.error(error);
            });
    }

    function getExchangeRates() {
        requestPostBSB();
        requestPostBNB();
        requestPostAlfa();
        requestPostParitet();
        requestPostBGPB();
        requestPostMTB();
        requestPostPayOkay();
    }

    let colNum;

    function sortTable(n) {
        let table, rows, desc, switching, i, x, y, shouldSwitch, dir, switchCount;
        table = document.getElementById("sortTable");
        switchCount = 0;
        switching = true;
        dir = "asc";
        desc = true;
        if (n === undefined || n === null) {
            if (!isExist(colNum)) {
                colNum = 0;
            }
            desc = false;
        } else {
            colNum = n;
        }

        rows = table.rows;
        for (const thElement of rows[0].getElementsByTagName("th")) {
            thElement.classList.remove("bg-info");
        }
        rows[0].getElementsByTagName("th")[colNum + 1].classList.add("bg-info");

        /* Make a loop that will continue until
        no switching has been done: */
        while (switching) {
            // Start by saying: no switching is done:
            switching = false;
            rows = table.rows;
            /* Loop through all table rows (except the
            first, which contains table headers): */
            for (i = 1; i < (rows.length - 1); i++) {
                // Start by saying there should be no switching:
                shouldSwitch = false;
                /* Get the two elements you want to compare,
                one from current row and one from the next: */
                x = rows[i].getElementsByTagName("TD")[colNum];
                y = rows[i + 1].getElementsByTagName("TD")[colNum];
                /* Check if the two rows should switch place,
                based on the direction, asc or desc: */
                let xValue = Number.parseFloat(x.innerText);
                if (isNaN(xValue)) {
                    xValue = Infinity;
                }
                let yValue = Number.parseFloat(y.innerText);
                if (isNaN(yValue)) {
                    yValue = Infinity;
                }
                if (dir === "asc") {
                    if (xValue > yValue) {
                        // If so, mark as a switch and break the loop:
                        shouldSwitch = true;
                        break;
                    }
                } else if (dir === "desc") {
                    if (xValue < yValue) {
                        // If so, mark as a switch and break the loop:
                        shouldSwitch = true;
                        break;
                    }
                }
            }
            if (shouldSwitch) {
                /* If a switch has been marked, make the switch
                and mark that a switch has been done: */
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
                // Each time a switch is done, increase this count by 1:
                switchCount++;
            } else {
                /* If no switching has been done AND the direction is "asc",
                set the direction to "desc" and run the while loop again. */
                if (switchCount === 0 && dir === "asc" && desc) {
                    dir = "desc";
                    switching = true;
                }
            }
        }
    }

    function setBlueColor(btn) {
        if (btn.classList.contains('btn-danger'))
            btn.classList.remove('btn-danger');
        if (!btn.classList.contains('btn-info'))
            btn.classList.add('btn-info');
    }

    function setRedColor(btn) {
        if (btn.classList.contains('btn-info'))
            btn.classList.remove('btn-info');
        if (!btn.classList.contains('btn-danger'))
            btn.classList.add('btn-danger');
    }

    function showElement(el) {
        el.style.display = 'block';
    }

    function hideElement(el) {
        el.style.display = 'none';
    }

    function isExist(el) {
        return !(el === undefined || el === null)
    }

    window.onload = () => {
        console.log('onload');
        getExchangeRates();
    };
</script>

</body>
</html>